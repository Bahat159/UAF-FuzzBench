- Reproduce: `valgrind ./nasm -f bin PoC -o /dev/null`
~~~
==8091== Invalid read of size 1
==8091==    at 0x402F378: strlen (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==8091==    by 0x805DA67: detoken (preproc.c:1305)
==8091==    by 0x806691D: pp_getline (preproc.c:5116)
==8091==    by 0x804C049: assemble_file (nasm.c:1233)
==8091==    by 0x804A0C8: main (nasm.c:453)
==8091==  Address 0x42a88c8 is 0 bytes inside a block of size 7 free'd
==8091==    at 0x402D358: free (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==8091==    by 0x804C8C3: nasm_free (malloc.c:77)
==8091==    by 0x805D98C: detoken (preproc.c:1284)
==8091==    by 0x806691D: pp_getline (preproc.c:5116)
==8091==    by 0x804C049: assemble_file (nasm.c:1233)
==8091==    by 0x804A0C8: main (nasm.c:453)
==8091==  Block was alloc'd at
==8091==    at 0x402C17C: malloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==8091==    by 0x804C7F6: nasm_malloc (malloc.c:47)
==8091==    by 0x805D7E9: new_Token (preproc.c:1226)
==8091==    by 0x8066136: expand_mmacro (preproc.c:4867)
==8091==    by 0x8066BA7: pp_getline (preproc.c:5211)
==8091==    by 0x804C049: assemble_file (nasm.c:1233)
==8091==    by 0x804A0C8: main (nasm.c:453)
~~~
