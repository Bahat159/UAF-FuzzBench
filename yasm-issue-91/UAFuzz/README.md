- Reproduce: `valgrind ./yasm PoC`
~~~
==3493== Invalid read of size 4
==3493==    at 0x80575F0: yasm_intnum_destroy (intnum.c:415)
==3493==    by 0x80A1E0A: expr_delete_term (expr.c:1131)
==3493==    by 0x80A0EBF: expr_simplify_identity (expr.c:582)
==3493==    by 0x80A11B7: expr_level_op (expr.c:700)
==3493==    by 0x80A1AC9: expr_level_tree (expr.c:986)
==3493==    by 0x80A1BEA: yasm_expr__level_tree (expr.c:1020)
==3493==    by 0x80A3DAC: yasm_insn_finalize (insn.c:256)
==3493==    by 0x8065353: x86_id_insn_finalize (x86id.c:1082)
==3493==    by 0x809FA5B: yasm_bc_finalize (bytecode.c:176)
==3493==    by 0x8059D9B: yasm_object_finalize (section.c:535)
==3493==    by 0x8049B73: do_assemble (yasm.c:527)
==3493==    by 0x804A3A6: main (yasm.c:752)
==3493==  Address 0x42422f4 is 4 bytes inside a block of size 8 free'd
==3493==    at 0x402D358: free (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==3493==    by 0x805EE8A: def_xfree (xmalloc.c:113)
==3493==    by 0x8057615: yasm_intnum_destroy (intnum.c:417)
==3493==    by 0x80A1156: expr_level_op (expr.c:689)
==3493==    by 0x80A1AC9: expr_level_tree (expr.c:986)
==3493==    by 0x80A1BEA: yasm_expr__level_tree (expr.c:1020)
==3493==    by 0x80A3DAC: yasm_insn_finalize (insn.c:256)
==3493==    by 0x8065353: x86_id_insn_finalize (x86id.c:1082)
==3493==    by 0x809FA5B: yasm_bc_finalize (bytecode.c:176)
==3493==    by 0x8059D9B: yasm_object_finalize (section.c:535)
==3493==    by 0x8049B73: do_assemble (yasm.c:527)
==3493==    by 0x804A3A6: main (yasm.c:752)
==3493==  Block was alloc'd at
==3493==    at 0x402C17C: malloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==3493==    by 0x805EDA9: def_xmalloc (xmalloc.c:69)
==3493==    by 0x8057599: yasm_intnum_copy (intnum.c:397)
==3493==    by 0x80A1CE6: expr_item_copy (expr.c:1089)
==3493==    by 0x80A1DC8: yasm_expr__copy_except (expr.c:1120)
==3493==    by 0x80A157C: expr_expand_equ (expr.c:834)
==3493==    by 0x80A1BC7: yasm_expr__level_tree (expr.c:1019)
==3493==    by 0x80A3DAC: yasm_insn_finalize (insn.c:256)
==3493==    by 0x8065353: x86_id_insn_finalize (x86id.c:1082)
==3493==    by 0x809FA5B: yasm_bc_finalize (bytecode.c:176)
==3493==    by 0x8059D9B: yasm_object_finalize (section.c:535)
==3493==    by 0x8049B73: do_assemble (yasm.c:527)
~~~
